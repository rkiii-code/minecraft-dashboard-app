version: "3.9"

services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.frontend
      args:
        VITE_API_BASE_URL: ${VITE_API_BASE_URL:-http://localhost:8080/api}
        VITE_PORT: ${VITE_PORT:-5173}
    image: minecraft-dashboard-frontend
    ports:
      - "${VITE_PORT:-5173}:80"
    restart: unless-stopped

  # backend:
  #   build:
  #     context: .
  #     dockerfile: Dockerfile.backend
  #   image: minecraft-dashboard-backend
  #   environment:
  #     PORT: ${PORT:-8080}
  #     DB_PATH: ${DB_PATH:-/app/data/app.db}
  #     JWT_SECRET: ${JWT_SECRET:-please-change-me}
  #     JWT_EXPIRES_IN: ${JWT_EXPIRES_IN:-24h}
  #     RCON_HOST: ${RCON_HOST:-minecraft}
  #     RCON_PORT: ${RCON_PORT:-25575}
  #     RCON_PASSWORD: ${RCON_PASSWORD:-changeme}
  #     RCON_POLL_INTERVAL_SEC: ${RCON_POLL_INTERVAL_SEC:-30}
  #     DEFAULT_AVATAR_URL: ${DEFAULT_AVATAR_URL:-/assets/default.jpg}
  #   volumes:
  #     - ./data:/app/data
  #   ports:
  #     - "${PORT:-8080}:${PORT:-8080}"
  #   depends_on:
  #     minecraft:
  #       condition: service_healthy
  #   restart: unless-stopped
  #   healthcheck:
  #     test: ["CMD", "curl", "-f", "http://localhost:${PORT}/healthz"]
  #     interval: 30s
  #     timeout: 5s
  #     retries: 3
  #     start_period: 20s

  # minecraft:
  #   image: itzg/minecraft-server:java21
  #   environment:
  #     EULA: "TRUE"
  #     ENABLE_RCON: "true"
  #     RCON_PASSWORD: ${RCON_PASSWORD:-changeme}
  #     RCON_PORT: ${RCON_PORT:-25575}
  #     VERSION: ${MC_VERSION:-1.21.1}
  #     TYPE: VANILLA
  #     MOTD: ${MC_MOTD:-Minecraft Dashboard Dev Server}
  #     MAX_PLAYERS: ${MC_MAX_PLAYERS:-5}
  #     VIEW_DISTANCE: ${MC_VIEW_DISTANCE:-10}
  #     MEMORY: ${MC_MEMORY:-2G}
  #   ports:
  #     - "${MC_SERVER_PORT:-25565}:25565"
  #     - "${RCON_PORT:-25575}:25575"
  #   volumes:
  #     - mc_data:/data
  #   restart: unless-stopped
  #   healthcheck:
  #     test: ["CMD", "mc-health"]
  #     interval: 30s
  #     timeout: 10s
  #     retries: 5
  #     start_period: 60s

# volumes:
#   mc_data:
